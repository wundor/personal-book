<nz-modal
  [(nzVisible)]="isVisible"
  nzTitle="Create transaction"
  (nzOnCancel)="handleCancel()"
>
  <form nz-form [formGroup]="linesForm" (ngSubmit)="submitForm()">
    <div *nzModalContent>
      <div nz-row>
        <div nz-col>
          <nz-form-item>
            <nz-form-control nzErrorTip="Should not be empty">
              <nz-date-picker
                [(ngModel)]="date"
                formControlName="date"
              ></nz-date-picker>
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col>
          <nz-form-item>
            <input
              formControlName="info"
              nz-input
              nzSize="large"
              placeholder="Notation"
            />
          </nz-form-item>
        </div>
      </div>

      <!-- <div nz-row *ngFor="let line of listOfLines; let i = index"> -->
      <div
        nz-row
        formArrayName="lines"
        *ngFor="let item of lines['controls']; let i = index"
      >
        <div nz-col [formGroupName]="i">
          <nz-form-item>
            <nz-form-control nzErrorTip="Enter name">
              <nz-autocomplete
                [nzDataSource]="filteredOptions"
                #auto
              ></nz-autocomplete>
              <input
                formControlName="account"
                class="account"
                nz-input
                placeholder="account"
                [(ngModel)]="inputValue"
                [nzAutocomplete]="auto"
                (ngModelChange)="onChange($event)"
              />
            </nz-form-control>
          </nz-form-item>
        </div>
        <div nz-col [formGroupName]="i">
          <nz-form-item>
            <input
              formControlName="amount"
              class="amount"
              nz-input
              placeholder="amount"
            />
            <i
              nz-icon
              nzType="setting"
              nzTheme="outline"
              class="dynamic-delete-button"
            ></i>
            <!-- (click)="removeField(i, $event)" -->
          </nz-form-item>
        </div>
      </div>

      <nz-form-item>
        <nz-form-control
          [nzXs]="{ span: 24, offset: 0 }"
          [nzSm]="{ span: 20, offset: 4 }"
        >
          <button
            nz-button
            nzType="dashed"
            class="add-button"
            (click)="addField($event)"
          >
            <i nz-icon nzType="plus"></i>
            Add line
          </button>
        </nz-form-control>
      </nz-form-item>
    </div>
    <nz-form-item>
      <div *nzModalFooter>
        <nz-form-control>
          <button nz-button nzType="default" (click)="handleCancel()">
            Cancel
          </button>
          <button
            nz-button
            nzType="primary"
            [disabled]="!linesForm.valid"
            [nzLoading]="isOkLoading"
            (click)="submitForm()"
          >
            Add
          </button>
        </nz-form-control>
      </div>
    </nz-form-item>
  </form>
</nz-modal>
